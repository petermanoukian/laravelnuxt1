{"version":3,"file":"register-CIkUMUOE.js","sources":["../../../../pages/admin/register.vue"],"sourcesContent":["<!-- pages/register.vue -->\r\n<script setup>\r\nimport { useAuthStore } from '~/stores/auth'\r\n\r\n\r\nimport { ref, onMounted, watch, computed } from 'vue'\r\nimport { useRouter, useRoute } from 'vue-router'\r\n\r\nimport Sidebar from '~/components/Sidebar.vue'\r\nimport MobileHeader from '~/components/MobileHeader.vue'\r\n\r\n\r\nconst authStore = useAuthStore()\r\nconst router = useRouter()\r\nconst route = useRoute()\r\nconst name = ref('')\r\nconst email = ref('')\r\nconst password = ref('')\r\nconst pic = ref(null)\r\nconst levell = ref('2')\r\nconst passwordError = ref('')\r\nconst emailError = ref('')\r\nconst fileError = ref('')\r\n\r\nconst resetForm = async () => {\r\n  name.value = ''\r\n  email.value = ''\r\n  password.value = ''\r\n\r\n  levell.value = '2'\r\n  passwordError.value = ''\r\n  emailError.value = ''\r\n  fileError.value = ''\r\n  await authStore.resetRegistrationState()\r\n  passwordError.value = ''\r\n  emailError.value = ''\r\n \r\n  \r\n  const fileInputs = document.querySelectorAll('input[type=\"file\"]');\r\n  if (fileInputs.length > 0) {\r\n\tfileInputs[0].value = '';\r\n  }\r\n  pic.value = null\r\n  \r\n  const form = document.getElementById('reg');\r\n  if (form) {\r\n\tform.reset();\r\n  } \r\n  \r\n}\r\n\r\nconst validateEmail = (email) => \r\n{\r\n\t  const re = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n\t  return re.test(email);\r\n}\r\n\r\nwatch(password, (newVal) => {\r\n  if (newVal.length < 7) {\r\n    passwordError.value = 'Password must be at least 7 characters long.';\r\n  } else {\r\n    passwordError.value = '';\r\n  }\r\n});\r\n\r\nwatch(email, (newVal) => {\r\n  if (!validateEmail(newVal)) {\r\n    emailError.value = 'Please enter a valid email address.';\r\n  } else {\r\n    emailError.value = '';\r\n  }\r\n});\r\n\r\nconst register = async () => \r\n{\r\n\r\n  if (password.value.length < 7) {\r\n    passwordError.value = 'Password must be at least 7 characters long.';\r\n    return;\r\n  }\r\n  else\r\n  {\r\n    passwordError.value = '';\r\n  }\r\n  if (!validateEmail(email.value)) \r\n  {\r\n    emailError.value = 'Please enter a valid email address.';\r\n    return;\r\n  } else \r\n  {\r\n    emailError.value = '';\r\n  }\r\n\r\n\r\n  const formData = new FormData()\r\n  formData.append('name', name.value)\r\n  formData.append('email', email.value)\r\n  formData.append('password', password.value)\r\n  formData.append('levell', levell.value)\r\n  if (pic.value) {\r\n    formData.append('pic', pic.value)\r\n  }\r\n  await authStore.register(formData)\r\n  setTimeout(resetForm, 2000)\r\n\t\r\n}\r\n\r\n\r\ndefinePageMeta({\r\n  middleware: ['auth' , 'check-admin'],\r\n  layout: 'admin'\r\n});\r\n\r\n\r\n\r\nonMounted(async () => {\r\n  await authStore.fetchUser()\r\n  authStore.resetRegistrationState()\r\n})\r\n\r\nwatch(route, () => {\r\n  resetForm()\r\n})\r\n\r\nconst regError = computed(() => authStore.regError); \r\nconst regSuccess = computed(() => authStore.regSuccess); \r\n\r\nconst handleFileChange = (event) => {\r\n  const file = event.target.files[0];\r\n  \r\n  if (file && !file.type.startsWith('image/')) {\r\n    fileError.value = 'Please upload a valid image file.';\r\n    pic.value = null;\r\n  } else {\r\n    fileError.value = '';\r\n    pic.value = file;\r\n\tfile.value ='';\r\n  }\r\n  \r\n  \r\n}\r\n</script>\r\n\r\n\r\n\r\n<template>\r\n\r\n\r\n<div  class=\"bg-gray-100 font-family-karla flex\">\r\n\t<Sidebar />\r\n\r\n    <div class=\"relative w-full flex flex-col h-screen overflow-y-hidden\">\r\n        <!-- Desktop Header -->\r\n        <header class=\"w-full items-center bg-white py-2 px-6 hidden sm:flex\">\r\n            <div class=\"w-1/2\"></div>\r\n            <div  class=\"relative w-1/2 flex justify-end\">\r\n\t\t\tAdd an Admin\r\n            </div>\r\n        </header>\r\n\r\n        <!-- Mobile Header & Nav -->\r\n       <MobileHeader />\r\n    \r\n        <div class=\"w-full h-screen overflow-x-hidden border-t flex flex-col\">\r\n            <main class=\"w-full flex-grow p-6\">\r\n                <h1 class=\"text-3xl text-black pb-6\">Full Admin</h1>\r\n\r\n\t\t\t\t<div class=\"flex items-center justify-center bg-gray-100\">\r\n\t\t\t\t\t<div class=\"max-w-md w-full bg-white p-8 shadow-md rounded-lg\">\r\n\t\t\t\t\t\t<h1 class=\"text-2xl font-bold mb-4\">Add an Admin</h1>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<form @submit.prevent=\"register\" id = 'reg' name = 'reg'>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<div class=\"mb-4\">\t\r\n\t\t\t\t\t\t  <label for=\"levell\" class=\"block text-sm font-medium text-gray-700\">Level</label>\r\n\t\t\t\t\t\t  <select v-model=\"levell\" required\r\n\t\t\t\t\t\t  class=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 \r\n\t\t\t\t\t\t  focus:border-indigo-500 sm:text-sm\">\r\n\t\t\t\t\t\t  <option value = '2'> Limited Admin</option>\r\n\t\t\t\t\t\t  <option value = '1'> Full Admin</option>\r\n\t\t\t\t\t\t  \r\n\t\t\t\t\t\t  </select>\r\n\t\t\t\t\t\t</div>  \r\n\r\n\t\t\t\t\t\t<div class=\"mb-4\">\t\r\n\t\t\t\t\t\t  <label for=\"name\" class=\"block text-sm font-medium text-gray-700\">Full Name</label>\r\n\t\t\t\t\t\t  <input v-model=\"name\" type=\"text\" placeholder=\"Name\" required\r\n\t\t\t\t\t\t  class=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"/>\r\n\t\t\t\t\t\t</div>  \r\n\t\t\t\t\t\t<div class=\"mb-4\">  \r\n\t\t\t\t\t\t  <label for=\"email\" class=\"block text-sm font-medium text-gray-700\">Email</label>\r\n\t\t\t\t\t\t  <input v-model=\"email\" type=\"email\" placeholder=\"Email\" required\r\n\t\t\t\t\t\t  class=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"/>\r\n\t\t\t\t\t\t <p v-if=\"emailError\" class=\"mt-2 text-sm text-red-600\">{{ emailError }}</p>\r\n\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"mb-4\">\r\n\t\t\t\t\t\t  <label for=\"name\" class=\"block text-sm font-medium text-gray-700\">Password</label>\r\n\t\t\t\t\t\t  <input v-model=\"password\" type=\"password\" placeholder=\"Password\" required\r\n\t\t\t\t\t\t  class=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"/>\r\n\t\t\t\t\t\t  <p v-if=\"passwordError\" class=\"mt-2 text-sm text-red-600\">{{ passwordError }}</p>\r\n\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<div class=\"mb-4\">\r\n\t\t\t\t\t\t\t<label for=\"pic\" class=\"block text-sm font-medium text-gray-700\">Picture</label>\r\n\t\t\t\t\t\t\t<input type=\"file\" @change=\"handleFileChange\" class=\"mt-1 block w-full px-3 py-2 \r\n\t\t\t\t\t\t\tborder border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\" \r\n\t\t\t\t\t\t\taccept=\"image/*\"/>\r\n\t\t\t\t\t\t\t<p v-if=\"fileError\" class=\"mt-2 text-sm text-red-600\">{{ fileError }}</p>\r\n\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<button type=\"submit\" class=\"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded\">Add Admin</button>\r\n\t\t\t\t\t\t<p v-if=\"regError\" class=\"mt-2 text-sm text-red-600\">{{ regError }}</p>\r\n\t\t\t\t\t\t<p v-if=\"regSuccess\" class=\"mt-2 text-sm text-red-600\">{{ regSuccess }}</p>\r\n\t\t\t\t\t</form>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t</div>\r\n\t\t\t  </div>\r\n\t\t\t  \r\n\t\t\t  \r\n\t\t\t  \r\n\t\t\t</main>\r\n\r\n            <footer class=\"w-full bg-white text-right p-4\">\r\n                \r\n            </footer>\r\n        </div>\r\n\t\t\r\n\t</div>\t\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t</div>\r\n\r\n\r\n\r\n</template>\r\n"],"names":["email"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAYA,UAAM,YAAY;AACH,cAAU;AACzB,UAAM,QAAQ;AACR,UAAA,OAAO,IAAI,EAAE;AACb,UAAA,QAAQ,IAAI,EAAE;AACd,UAAA,WAAW,IAAI,EAAE;AACjB,UAAA,MAAM,IAAI,IAAI;AACd,UAAA,SAAS,IAAI,GAAG;AAChB,UAAA,gBAAgB,IAAI,EAAE;AACtB,UAAA,aAAa,IAAI,EAAE;AACnB,UAAA,YAAY,IAAI,EAAE;AAExB,UAAM,YAAY,YAAY;AAC5B,WAAK,QAAQ;AACb,YAAM,QAAQ;AACd,eAAS,QAAQ;AAEjB,aAAO,QAAQ;AACf,oBAAc,QAAQ;AACtB,iBAAW,QAAQ;AACnB,gBAAU,QAAQ;AAClB,YAAM,UAAU;AAChB,oBAAc,QAAQ;AACtB,iBAAW,QAAQ;AAGb,YAAA,aAAsB,SAAA,iBAAiB,oBAAoB;AAC7D,UAAA,WAAW,SAAS,GAAG;AACjB,mBAAA,CAAC,EAAE,QAAQ;AAAA,MACrB;AACA,UAAI,QAAQ;AAEN,YAAA,OAAgB,SAAA,eAAe,KAAK;AAC1C,UAAI,MAAM;AACX,aAAK,MAAM;AAAA,MACV;AAAA,IAAA;AAII,UAAA,gBAAgB,CAACA,WACvB;AACG,YAAM,KAAK;AACJ,aAAA,GAAG,KAAKA,MAAK;AAAA,IAAA;AAGjB,UAAA,UAAU,CAAC,WAAW;AACtB,UAAA,OAAO,SAAS,GAAG;AACrB,sBAAc,QAAQ;AAAA,MAAA,OACjB;AACL,sBAAc,QAAQ;AAAA,MACxB;AAAA,IAAA,CACD;AAEK,UAAA,OAAO,CAAC,WAAW;AACnB,UAAA,CAAC,cAAc,MAAM,GAAG;AAC1B,mBAAW,QAAQ;AAAA,MAAA,OACd;AACL,mBAAW,QAAQ;AAAA,MACrB;AAAA,IAAA,CACD;AAiDD,UAAM,OAAO,MAAM;AACP;IAAA,CACX;AAED,UAAM,WAAW,SAAS,MAAM,UAAU,QAAQ;AAClD,UAAM,aAAa,SAAS,MAAM,UAAU,UAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}