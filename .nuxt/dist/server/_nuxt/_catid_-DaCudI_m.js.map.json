{"file":"_catid_-DaCudI_m.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAWA,UAAM,EAAE,MAAO,gBAAgB,IAAI,OAAO;AAWxB,iBAAa;AAEhB,cAAU;AACzB,UAAM,QAAQ;AACR,UAAA,SAAS,MAAM,OAAO;AAEtB,UAAA,OAAO,IAAI,EAAE;AACb,UAAA,MAAM,IAAI,EAAE;AACZ,UAAA,QAAQ,IAAI,EAAE;AACd,UAAA,cAAc,IAAI,IAAI;AAChB,QAAI,IAAI;AACd,UAAA,YAAY,IAAI,EAAE;AAClB,UAAA,WAAW,IAAI,EAAE;AACjB,UAAA,SAAS,IAAI,EAAE;AAGrB,QAAG,UAAU;AACZ,YAAM,QAAQ;AAoDT,UAAA,kBAAkB,CAAC,aAAa;AAE9B,YAAA,QAAQ,WAAW,SAAS,KAAK;AAAA,IAAA;AAGzC,UAAM,yBAAyB,MAAM;AACnC,UAAI,MAAM,SAAS,KAAK,MAAM,QAAQ;AAC9B,cAAA,cAAc,OAAO,MAAM,KAAK;AACtC,cAAM,mBAAmB,KAAK,MAAM,KAAK,CAAO,QAAA,IAAI,OAAO,WAAW;AACtE,oBAAY,QAAQ,oBAAoB;AAAA,MAE1C;AAAA,IAAA;AAKF,UAAM,MAAM,sBAAsB;AAE5B,UAAA,aAAa,CAAC,aAAa;AACvB,cAAA,IAAI,wBAAwB,QAAQ;AAC5C,sBAAgB,QAAQ;AAAA,IAAA,CACzB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","names":[],"sources":["../../../../pages/admin/subcat/addsubcat/[catid].vue"],"sourcesContent":["<!-- pages/admin/subcat/addsubcat/[catid].vue -->\r\n<script setup>\r\nimport { useAuthStore } from '~/stores/auth'\r\nimport { ref, onMounted, watch, computed } from 'vue'\r\nimport { useRouter, useRoute } from 'vue-router'\r\nimport Sidebar from '~/components/Sidebar.vue'\r\nimport MobileHeader from '~/components/MobileHeader.vue'\r\nimport { useCat } from '~/composables/useCat'\r\nimport Multiselect from 'vue-multiselect'\r\nimport 'vue-multiselect/dist/vue-multiselect.css'\r\n\r\nconst { cats,  fetchCatsCommon } = useCat()\r\n\r\n\r\ndefinePageMeta({\r\n  middleware: 'auth',\r\n  layout: 'admin'\r\n});\r\n\r\n\r\nimport { useRuntimeConfig } from '#imports'\r\n\r\nconst authStore = useAuthStore()\r\n\r\nconst router = useRouter()\r\nconst route = useRoute()\r\nconst catidx = route.params.catid\r\n\r\nconst name = ref('')\r\nconst des = ref('')\r\nconst catid = ref('')\r\nconst selectedCat = ref(null)\r\nconst pic = ref(null)\r\nconst fileError = ref('')\r\nconst adderror = ref('')\r\nconst addsuc = ref('')\r\n\r\n\r\nif(catidx != \"\")\r\n\tcatid.value = catidx\r\n\r\n\r\nconst addsubcat = async () => {\r\n  const { $api } = useNuxtApp()\r\n  const apiUrl = useRuntimeConfig().public.apiBaseUrl\r\n\r\n  const formData = new FormData()\r\n  formData.append('name', name.value)\r\n  formData.append('des', des.value)\r\n  formData.append('catid', catid.value)\r\n  if (pic.value) {\r\n    formData.append('pic', pic.value)\r\n  }\r\n\r\n  try \r\n  {\r\n    const response = await $api.post(`${apiUrl}/admin/subcat/add`, formData)\r\n    console.log('SubCategory added successfully:', response.data)\r\n\taddsuc.value = 'subcategoty aded ' + name.value +  ' ... you will be redircted in a monent ...'\r\n\tsetTimeout(resetForm, 100)\r\n\tsetTimeout(() => {\r\n\t\trouter.push('/admin/subcat/viewsubcat'); \r\n\t}, 300); \r\n\t\r\n  } \r\n  catch (error) \r\n  {\r\n\t\tif (error.response && error.response.status === 422) \r\n\t\t{\r\n          adderror.value = error.response.data.message;\r\n        } \r\n\t\telse \r\n\t\t{\r\n          adderror.value = 'An unexpected error occurred.';\r\n        }\r\n  }\r\n}\r\n\r\n\r\nonMounted(async () => \r\n{\r\n\tawait authStore.fetchUser()\r\n\tawait fetchCatsCommon()\r\n\tupdateSelectedCategory()\r\n\tconst multiselectComponent = $refs.multiselect\r\n\tif (multiselectComponent) \r\n\t{\r\n\t\tmultiselectComponent.$on('input', handleSelectCat)\r\n\t}\r\n})\r\n\r\nconst handleSelectCat = (selected) => {\r\n \r\n  catid.value = selected ? selected.id : null\r\n}\r\n\r\nconst updateSelectedCategory = () => {\r\n  if (catid.value && cats.value.length) {\r\n    const catidNumber = Number(catid.value) // Convert catid.value to a number\t\r\n    const selectedCategory = cats.value.find(cat => cat.id === catidNumber)\r\n    selectedCat.value = selectedCategory || null\r\n\r\n  }\r\n}\r\n\r\n\r\n\r\nwatch(cats, updateSelectedCategory)\r\n\r\nwatch(selectedCat, (newValue) => {\r\n  console.log('selectedCat changed:', newValue);\r\n  handleSelectCat(newValue);\r\n})\r\n\r\n\r\nconst handleFileChange = (event) => {\r\n  const file = event.target.files[0];\r\n  \r\n  if (file && !file.type.startsWith('image/')) {\r\n    fileError.value = 'Please upload a valid image file.';\r\n    pic.value = null;\r\n  } else {\r\n    fileError.value = '';\r\n    pic.value = file;\r\n  }\r\n  \r\n  \r\n}\r\n\r\nconst resetForm = async () => {\r\n  name.value = ''\r\n  des.value = ''\r\n  catid.value = ''\r\n  pic.value = null\r\n  fileError.value = ''\r\n  adderror.value = ''\r\n  addsuc.value =''\r\n  \r\n  const fileInputs = document.querySelectorAll('input[type=\"file\"]');\r\n  if (fileInputs.length > 0) {\r\n\tfileInputs[0].value = '';\r\n  }\r\n}\r\n</script>\r\n\r\n\r\n<template>\r\n\r\n\t<div  class=\"bg-gray-100 font-family-karla flex\">\r\n\t\t<Sidebar />\r\n\t\t<div class=\"relative w-full flex flex-col h-screen overflow-y-hidden\">\r\n\t\t\t<header class=\"w-full items-center bg-white py-2 px-6 hidden sm:flex\">\r\n\t\t\t\t<div class=\"w-1/2\"></div>\r\n\t\t\t\t<div  class=\"relative w-1/2 flex justify-end\"> Add sub Category </div>\r\n\t\t\t</header>\r\n\r\n\t\t   <MobileHeader />\r\n\t\t\t<div class=\"w-full h-screen overflow-x-hidden border-t flex flex-col\">\r\n\t\t\t\t<main class=\"w-full flex-grow p-6\">\r\n\t\t\t\t\t<div class=\"flex items-center justify-center bg-gray-100\">\r\n\t\t\t\t\t\t<div class=\"fullwidth90 bg-white p-8 shadow-md rounded-lg\">\r\n\t\t\t\t\t\t\t<h1 class=\"text-2xl font-bold mb-4\">Add Sub Category  Catid {{ catid }}</h1>\r\n\t\t\t\t\t\t\t<p class=\"mb-4\">\r\n\t\t\t\t\t\t\t  <NuxtLink to=\"/admin/subcat/viewsubcat\" class=\" widthmax300 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded\">\r\n\t\t\t\t\t\t\t  <i class=\"fas fa-align-left mr-3\"></i>View subcategories</NuxtLink>\r\n\t\t\t\t\t\t\t </p>\r\n\t\t\t\t\t\t\t<form @submit.prevent=\"addsubcat\">\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<div class=\"mb-4\">\t\r\n\t\t\t\t\t\t\t\t\t<label for=\"catid\" class=\"block text-sm font-medium text-gray-700\">Category</label>\r\n\t\t\t\t\t\t\t\t\t<Multiselect\r\n\t\t\t\t\t\t\t\t\t  ref=\"multiselect\"\r\n\t\t\t\t\t\t\t\t\t  v-model=\"selectedCat\"\r\n\t\t\t\t\t\t\t\t\t  :options=\"cats\"\r\n\t\t\t\t\t\t\t\t\t  label=\"name\"\r\n\t\t\t\t\t\t\t\t\t  track-by=\"id\"\r\n\t\t\t\t\t\t\t\t\t  placeholder=\"Choose category\"\r\n\t\t\t\t\t\t\t\t\t  :searchable=\"true\"\r\n\t\t\t\t\t\t\t\t\t  :close-on-select=\"true\"\r\n\t\t\t\t\t\t\t\t\t  :allow-empty=\"false\"\r\n\t\t\t\t\t\t\t\t\t  class=\"mt-1 block w-full\"\r\n\t\t\t\t\t\t\t\t\t  @change=\"handleSelectCat\"\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t   catid  {{ catid }}\r\n\t\t\t\t\t\t\t\t   <p v-if=\"selectedCat\">{{ selectedCat.id }} </p>\r\n\t\t\t\t\t\t\t\t   <p v-else>Nothin</p>\r\n\t\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t\t   <p v-if=\"selectedCat?.id\">Selected Category ID: {{ selectedCat.id }}</p>\r\n\t\t\t\t\t\t\t\t   <p v-else>No category selected</p>\r\n\t\t  \r\n\t\t\t\t\t\t\t\t</div>  \r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"mb-4\">\t\r\n\t\t\t\t\t\t\t\t  <label for=\"name\" class=\"block text-sm font-medium text-gray-700\">Title</label>\r\n\t\t\t\t\t\t\t\t  <input v-model=\"name\" type=\"text\" placeholder=\"Name\" required\r\n\t\t\t\t\t\t\t\t  class=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 \r\n\t\t\t\t\t\t\t\t  focus:border-indigo-500 sm:text-sm\"/>\r\n\t\t\t\t\t\t\t\t</div>  \r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<div class=\"mb-4\">\t\r\n\t\t\t\t\t\t\t\t\t<label for=\"des\" class=\"block text-sm font-medium text-gray-700\"> Short Description</label>\r\n\t\t\t\t\t\t\t\t\t<textarea v-model=\"des\" \r\n\t\t\t\t\t\t\t\t\tclass=\"mt-1 block w-full px-3 py-3 textareashort border border-gray-300 rounded-md \"/>\r\n\t\t\t\t\t\t\t\t</div> \r\n\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<div class=\"mb-4\">\r\n\t\t\t\t\t\t\t\t\t<label for=\"pic\" class=\"block text-sm font-medium text-gray-700\">Picture</label>\r\n\t\t\t\t\t\t\t\t\t<input type=\"file\" @change=\"handleFileChange\" class=\"mt-1 block w-full px-3 py-2 \r\n\t\t\t\t\t\t\t\t\tborder border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\" \r\n\t\t\t\t\t\t\t\t\taccept=\"image/*\"/>\r\n\t\t\t\t\t\t\t\t\t<p v-if=\"fileError\" class=\"mt-2 text-sm text-red-600\">{{ fileError }}</p>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<button type=\"submit\" class=\"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded\">Add Admin</button>\r\n\t\t\t\t\t\t\t\t<p v-if=\"adderror\" class=\"mt-2 text-sm text-red-600\">{{ adderror }}</p>\r\n\t\t\t\t\t\t\t\t<p v-if=\"addsuc\" class=\"mt-2 text-sm text-red-600\">{{ addsuc }}</p>\r\n\t\t\t\t\t\t\t</form>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t  </div>\r\n\t\t\t\t   \r\n\t\t\t\t</main>\r\n\t\t\t\t<footer class=\"w-full bg-white text-right p-4\"></footer>\r\n\t\t\t</div>\t\r\n\t\t</div>\t\r\n\t</div>\r\n</template>\r\n"],"version":3}