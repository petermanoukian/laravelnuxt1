{"file":"_subid_-B04ACkHo.js","mappings":"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","names":[],"sources":["../../../../pages/admin/prod/addprodbycatidsubid/[catid]/[subid].vue"],"sourcesContent":["<!-- pages/admin/prod/addproduct.vue -->\r\n<script setup>\r\nimport { useAuthStore } from '~/stores/auth'\r\nimport { ref, onMounted, watch, computed } from 'vue'\r\nimport { useRouter, useRoute } from 'vue-router'\r\nimport Sidebar from '~/components/Sidebar.vue'\r\nimport MobileHeader from '~/components/MobileHeader.vue'\r\nimport { useCat } from '~/composables/useCat'\r\nimport { useSubcat } from '~/composables/useSubcat'\r\nimport { useTagg } from '~/composables/useTagg'\r\nimport Multiselect from 'vue-multiselect'\r\nimport 'vue-multiselect/dist/vue-multiselect.css'\r\n\r\nconst { cats,  fetchCatsCommon } = useCat()\r\nconst { subcats,  fetchSubcatsCommon } = useSubcat()\r\nconst { taggs,  fetchTaggsCommon } = useTagg()\r\n\r\n\r\ndefinePageMeta({\r\n  middleware: 'auth',\r\n  layout: 'admin'\r\n});\r\n\r\n\r\nimport { useRuntimeConfig } from '#imports'\r\nconst authStore = useAuthStore()\r\nconst router = useRouter()\r\nconst route = useRoute()\r\nconst name = ref('')\r\nconst catid = ref('')\r\nconst subid = ref('')\r\nconst des = ref('')\r\nconst dess = ref('')\r\nconst pic = ref(null)\r\nconst fileError = ref('')\r\nconst adderror = ref('')\r\nconst addsuc = ref('')\r\nconst selectedCat = ref(null)\r\nconst selectedSubCat = ref(null)\r\nconst taggid = ref([])\r\nconst selectedTags= ref([])\r\nconst firsloader = ref(0)\r\nconst catidx = route.params.catid\r\nconst subidx = route.params.subid\r\n\r\nif(catidx)\r\n{\r\n\tcatid.value = catidx\r\n}\r\nif(subidx)\r\n{\r\n\tsubid.value = subidx\r\n}\r\n\r\n\r\nconst handleSelectCat = (selected) => {\r\n  \r\n  catid.value = selected ? selected.id : null\r\n  if(firsloader > 1)\r\n  {\r\n\tclearsubcat()\r\n  }\r\n  firsloader.value +=1\r\n\r\n}\r\n\r\nconst handleSelectSubCat = (selected) => {\r\n\r\n  subid.value = selected ? selected.id : null\r\n}\r\n\r\n\r\n\r\nonMounted(async () => {\r\n\tawait authStore.fetchUser()\r\n\t\r\n\r\n\tawait fetchCatsCommon()\r\n\tawait fetchSubcatsCommon(catid.value)\r\n\tawait fetchTaggsCommon()\r\n\tupdateSelectedCategory()\r\n\tupdateSelectedSubCategory()\r\n\t\r\n\t/*\r\n\tconst multiselectcatComponent = $refs.multiselectcat\r\n\tif (multiselectcatComponent) \r\n\t{\r\n\t\tmultiselectcatComponent.$on('input', handleSelectCat)\r\n\t}\r\n\r\n\t\r\n\tconst multiselectsubcatComponent = $refs.multiselectsubcat\r\n\tif (multiselectsubcatComponent) \r\n\t{\r\n\t\tmultiselectsubcatComponent.$on('input', handleSelectSubCat)\r\n\t}\r\n\t*/\r\n\r\n\teditor.value = useEditor({\r\n\tcontent: dess.value,\r\n\textensions: [TiptapStarterKit],\r\n\tonUpdate: ({ editor }) => {\r\n\t  dess.value = editor.getHTML(); // Update dess whenever the content changes\r\n\t},\r\n\t})\r\n\r\n  \r\n})\r\n\r\nconst updateSelectedCategory = () => {\r\n\r\n  if (catid.value && cats.value.length) {\r\n    const catidNumber = Number(catid.value) // Convert catid.value to a number\r\n    const selectedCategory = cats.value.find(cat => cat.id === catidNumber)\r\n    selectedCat.value = selectedCategory || null\r\n  }\r\n}\r\n\r\nconst updateSelectedSubCategory = () => {\r\n  if (subid.value && subcats.value.length) {\r\n    const subcatidNumber = Number(subid.value); // Convert subid.value to a number\r\n    console.log('Subcategories:', subcats.value);\r\n    console.log('Subcategory ID to match:', subcatidNumber);\r\n\r\n    const selectedSubCategory = subcats.value.find(sub => {\r\n      console.log('Checking subcategory:', sub.id, 'against', subcatidNumber);\r\n      return sub.id === subcatidNumber;\r\n    });\r\n\r\n    selectedSubCat.value = selectedSubCategory || null;\r\n  \r\n  } else {\r\n    console.log('Subid or subcats array is invalid');\r\n  }\r\n}\r\n\r\n\r\nwatch(firsloader, (newfirsloader) => {\r\n\r\n  if(newfirsloader > 1)\r\n  {\r\n\tclearsubcat()\r\n  }\r\n  \r\n})\r\n\r\nwatch(catid, (newCatid) => {\r\n\r\n  \r\n  fetchSubcatsCommon(newCatid);\r\n})\r\n\r\n\r\n\r\nwatch(cats, subcats, updateSelectedCategory ,updateSelectedSubCategory)\r\n\r\n\r\n\r\nwatch(selectedCat, (newValue) => {\r\n  console.log('selectedCat changed:', newValue)\r\n\r\n  handleSelectCat(newValue)\r\n\r\n})\r\n\r\nwatch(selectedSubCat, (newValue2) => {\r\n  console.log('selectedCat changed:', newValue2)\r\n  handleSelectSubCat(newValue2)\r\n})\r\n\r\nwatch(selectedTags, (newTags) => {\r\n  \r\n  taggid.value = newTags.map(tag => tag.id);\r\n})\r\n\r\nconst clearsubcat = () => {\r\n\r\n  subid.value = null\r\n  selectedSubCat.value = null\r\n}\r\nconst addprod = async () => {\r\n  const { $api } = useNuxtApp()\r\n  const apiUrl = useRuntimeConfig().public.apiBaseUrl\r\n\r\n  const formData = new FormData()\r\n  formData.append('name', name.value)\r\n  formData.append('catid', catid.value)\r\n  formData.append('subid', subid.value)\r\n  formData.append('des', des.value)\r\n  formData.append('dess', dess.value)\r\n  formData.append('taggid', taggid.value)\r\n  if (pic.value) {\r\n    formData.append('pic', pic.value)\r\n  }\r\n\r\n  try \r\n  {\r\n    const response = await $api.post(`${apiUrl}/admin/prod/add`, formData)\r\n    console.log(' added successfully:', response.data)\r\n\taddsuc.value = 'product added ' + name.value +  ' ... you will be redircted in a monent ...'\r\n\tsetTimeout(() => {\r\n\t\trouter.push('/admin/prod/viewprod'); \r\n    }, 300);\t\r\n  } \r\n  catch (error) \r\n  {\r\n\tif (error.response && error.response.status === 422) \r\n\t{\r\n\t  adderror.value = error.response.data.message;\r\n\t} else {\r\n\t  adderror.value = 'An unexpected error occurred.';\r\n\t}\r\n  }\r\n\r\n}\r\n\r\nlet editor = ref(null)\r\n\r\nconst handleFileChange = (event) => {\r\n  const file = event.target.files[0];\r\n  \r\n  if (file && !file.type.startsWith('image/')) {\r\n    fileError.value = 'Please upload a valid image file.';\r\n    pic.value = null;\r\n  } else {\r\n    fileError.value = '';\r\n    pic.value = file;\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.textareashort\r\n{\r\n\theight:80px;\r\n}\r\n.textarealongborder\r\n{\r\n\theight:150px;border:1px solid #333;width:100%;  padding: 10px;\r\n}\r\n\r\n\r\n.editable-content \r\n{\r\n  border: 1px solid lightgray; /* Default border */\r\n  border-radius: 5px;\r\n  padding: 10px;\r\n  min-height: 100px; /* Set a minimum height */\r\n  max-height: 300px; /* Optional: Set a maximum height */\r\n  overflow-y: auto; /* Add scrollbar if content exceeds max height */\r\n}\r\n\r\n\r\n.editable-content:focus {\r\n  outline: none;\r\n  border: 1px solid transparent; \r\n}\r\n\r\n\r\n</style>\r\n\r\n<template>\r\n\r\n\r\n<div  class=\"bg-gray-100 font-family-karla flex\">\r\n\t<Sidebar />\r\n\r\n    <div class=\"relative w-full flex flex-col h-screen overflow-y-hidden\">\r\n        <!-- Desktop Header -->\r\n        <header class=\"w-full items-center bg-white py-2 px-6 hidden sm:flex\">\r\n            <div class=\"w-1/2\"></div>\r\n            <div  class=\"relative w-1/2 flex justify-end\"> Add Product  \t\t\t \r\n            </div>\r\n        </header>\r\n\r\n        <!-- Mobile Header & Nav -->\r\n       <MobileHeader />\r\n    \r\n        <div class=\"w-full h-screen overflow-x-hidden border-t flex flex-col\">\r\n            <main class=\"w-full flex-grow p-6\">\r\n\r\n\t\t\t\t<div class=\"flex items-center justify-center bg-gray-100\">\r\n\t\t\t\t\t<div class=\"fullwidth90 bg-white p-8 shadow-md rounded-lg\">\r\n\t\t\t\t\t\t<h1 class=\"text-2xl font-bold mb-4\">Add Product By Category  Sub Category</h1>\r\n\t\t\t\t\t\t<p class=\"mb-4\">\r\n\t\t\t\t\t\t  <NuxtLink to=\"/admin/prod/viewprod\" class=\" widthmax300 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded\">\r\n\t\t\t\t\t\t  <i class=\"fas fa-align-left mr-3\"></i>View Products</NuxtLink>\r\n\t\t\t\t\t\t </p>\r\n\t\t\t\t\t\t<form @submit.prevent=\"addprod\">\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<div class=\"mb-4\">\t\r\n\t\t\t\t\t\t  <label for=\"catid\" class=\"block text-sm font-medium text-gray-700\">Category</label>\r\n\t\t\t\t\t\t<!--\r\n\t\t\t\t\t\t  <select v-model=\"catid\"  placeholder=\"Cat\" required\r\n\t\t\t\t\t\t  class=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 \r\n\t\t\t\t\t\t  focus:border-indigo-500 sm:text-sm\"\r\n\t\t\t\t\t\t   @change=\"fetchSubcatsCommon(catid)\">\r\n\t\t\t\t\t\t  <option value = '' disabled> Choose category</option>\r\n\t\t\t\t\t\t  <option v-for=\"cat in cats\" :value = \"cat.id\"> {{ cat.name }}</option>\r\n\t\t\t\t\t\t  </select>\r\n\t\t\t\t\t\t-->  \r\n\t\t\t\t\t\t  \r\n\t\t\t\t\t\t  <Multiselect\r\n\t\t\t\t\t\t\t  ref=\"multiselectcat\"\r\n\t\t\t\t\t\t\t  v-model=\"selectedCat\"\r\n\t\t\t\t\t\t\t  :options=\"cats\"\r\n\t\t\t\t\t\t\t  label=\"name\"\r\n\t\t\t\t\t\t\t  track-by=\"id\"\r\n\t\t\t\t\t\t\t  placeholder=\"Choose category\"\r\n\t\t\t\t\t\t\t  :searchable=\"true\"\r\n\t\t\t\t\t\t\t  :close-on-select=\"true\"\r\n\t\t\t\t\t\t\t  :allow-empty=\"false\"\r\n\t\t\t\t\t\t\t  class=\"mt-1 block w-full\"\r\n\t\t\t\t\t\t\t  @change=\"handleSelectCat,fetchSubcatsCommon(catid) \"\r\n\t\t\t\t\t\t\t/>  \r\n\t\t\t\t\t\t</div>  \r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<div class=\"mb-4\">\t\r\n\t\t\t\t\t\t  <label for=\"subid\" class=\"block text-sm font-medium text-gray-700\">SubCategory</label>\r\n\t\t\t\t\t\t\t<Multiselect\r\n\t\t\t\t\t\t\t  ref=\"multiselectsubcat\"\r\n\t\t\t\t\t\t\t  v-model=\"selectedSubCat\"\r\n\t\t\t\t\t\t\t  :options=\"subcats\"\r\n\t\t\t\t\t\t\t  label=\"name\"\r\n\t\t\t\t\t\t\t  track-by=\"id\"\r\n\t\t\t\t\t\t\t  placeholder=\"Choose subcategory\"\r\n\t\t\t\t\t\t\t  :searchable=\"true\"\r\n\t\t\t\t\t\t\t  :close-on-select=\"true\"\r\n\t\t\t\t\t\t\t  :allow-empty=\"false\"\r\n\t\t\t\t\t\t\t  class=\"mt-1 block w-full\"\t/>\r\n\t\t\t\t\t\t   subid  {{ subid }}\r\n\t\t\t\t\t\t</div> \r\n\r\n\r\n\r\n\t\t\t\t\t\t<div class=\"mb-4\">\t\r\n\t\t\t\t\t\t    <label for=\"taggid\" class=\"block text-sm font-medium text-gray-700\">Tags </label>\r\n\t\t\t\t\t\t\t<Multiselect\r\n\t\t\t\t\t\t\t\tv-model=\"selectedTags\"\r\n\t\t\t\t\t\t\t\t:options=\"taggs\"\r\n\t\t\t\t\t\t\t\tlabel=\"name\"\r\n\t\t\t\t\t\t\t\ttrack-by=\"id\"\r\n\t\t\t\t\t\t\t\tplaceholder=\"Choose tags\"\r\n\t\t\t\t\t\t\t\t:searchable=\"true\"\r\n\t\t\t\t\t\t\t\t:close-on-select=\"true\"\r\n\t\t\t\t\t\t\t\t:allow-empty=\"true\"\r\n\t\t\t\t\t\t\t\tclass=\"mt-1 block w-full\"\r\n\t\t\t\t\t\t\t\t:multiple=\"true\" \r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t  <br>\r\n\t\t\t\t\t\t  TAGS {{ taggid }} <br>\r\n\t\t\t\t\t\t  TAGID {{ selectedTags }} <br>\r\n\t\t\t\t\t\t</div>  \t\t\t\t\t\t\t\r\n\t\t\t\t\t\t<div class=\"mb-4\">\t\r\n\t\t\t\t\t\t  <label for=\"name\" class=\"block text-sm font-medium text-gray-700\"> Name</label>\r\n\t\t\t\t\t\t  <input v-model=\"name\" type=\"text\" placeholder=\"Name\" required\r\n\t\t\t\t\t\t  class=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none \"/>\r\n\t\t\t\t\t\t</div> \r\n\t\t\t\t\t\t<div class=\"mb-4\">\t\r\n\t\t\t\t\t\t  <label for=\"des\" class=\"block text-sm font-medium text-gray-700\"> Short Description</label>\r\n\t\t\t\t\t\t  <textarea v-model=\"des\" type=\"text\" \r\n\t\t\t\t\t\t  class=\"mt-1 block w-full px-3 py-3 textareashort border border-gray-300 rounded-md \"/>\r\n\t\t\t\t\t\t</div>  \r\n\r\n\t\t\t\t\t\t<div class=\"mb-4\">\t\r\n\t\t\t\t\t\t\t<label for=\"dess\" class=\"block text-sm font-medium text-gray-700\"> Long Description</label>    \r\n\t\t\t\t\t\t\t<client-only>\r\n\t\t\t\t\t\t\t  <tiptap-editor v-model=\"dess\" class = 'textarealongborder'\r\n\t\t\t\t\t\t\t  :editor=\"editor\"/>\r\n\t\t\t\t\t\t\t</client-only>\r\n\t\t\t\t\t\t</div>  \r\n\r\n\t\t\t\t\t\t<div class=\"mb-4\">\r\n\t\t\t\t\t\t\t<label for=\"pic\" class=\"block text-sm font-medium text-gray-700\">Picture</label>\r\n\t\t\t\t\t\t\t<input type=\"file\" @change=\"handleFileChange\" class=\"mt-1 block w-full px-3 py-2 \r\n\t\t\t\t\t\t\tborder border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\" \r\n\t\t\t\t\t\t\taccept=\"image/*\"/>\r\n\t\t\t\t\t\t\t<p v-if=\"fileError\" class=\"mt-2 text-sm text-red-600\">{{ fileError }}</p>\r\n\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<button type=\"submit\" class=\"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded\">Add</button>\r\n\t\t\t\t\t\t<p v-if=\"adderror\" class=\"mt-2 text-sm text-red-600\">{{ adderror }}</p>\r\n\t\t\t\t\t\t<p v-if=\"addsuc\" class=\"mt-2 text-sm text-red-600\">{{ addsuc }}</p>\r\n\t\t\t\t\t</form>\r\n\r\n\t\t\t\t\t</div>\r\n\t\t\t  </div>\r\n  \r\n            </main>\r\n    \r\n            <footer class=\"w-full bg-white text-right p-4\"></footer>\r\n        </div>\r\n\t\t\r\n\t</div>\t\r\n\t\r\n</div>\r\n\r\n</template>\r\n"],"version":3}