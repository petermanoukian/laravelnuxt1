{"version":3,"file":"checkAdmin-NE1_cfZq.js","sources":["../../../../middleware/checkAdmin.js"],"sourcesContent":["import { useAuthStore } from '~/stores/auth'\r\n\r\nexport default defineNuxtRouteMiddleware(async (to, from) => {\r\n  if (process.client) {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) {\r\n      // If there's no token, redirect to login\r\n      return navigateTo('/login');\r\n    }\r\n\r\n    const authStore = useAuthStore();\r\n\r\n    // Fetch user if not already fetched\r\n    if (!authStore.user) {\r\n      await authStore.fetchUser();\r\n    }\r\n\r\n    // Check if user levell is 1\r\n    if (authStore.user.levell !== 1) {\r\n      // Clear the token and user data if access is forbidden\r\n\r\n\r\n      // Provide a JSON response if the request expects JSON\r\n      if (to.meta && to.meta.expectsJson) {\r\n           return navigateTo('/forbidden') // Redirect to a custom page or handle it\r\n\r\n      }\r\n\r\n      // Optionally, you can return a specific response code here\r\n      // without redirecting.\r\n     return navigateTo('/forbidden');\r\n    }\r\n  }\r\n});\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAGE,MAAoB,aAAA,0BAAA,OAAA,IAAA,SAAA;;"}