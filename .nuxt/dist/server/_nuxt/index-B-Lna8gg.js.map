{"version":3,"file":"index-B-Lna8gg.js","sources":["../../../../pages/admin/prod/viewprodbycatid/index.vue"],"sourcesContent":["<!-- pages/admin/subcat/viewprod.vue -->\r\n<script setup>\r\nimport { useAuthStore } from '~/stores/auth'\r\nimport { ref, onMounted, watch, computed } from 'vue'\r\nimport { useRouter, useRoute } from 'vue-router'\r\nimport Sidebar from '~/components/Sidebar.vue'\r\nimport MobileHeader from '~/components/MobileHeader.vue'\r\nimport { useProdPagination } from '~/composables/useProdpagination'\r\n\r\nimport { useCat } from '~/composables/useCat'\r\nimport { useSubcat } from '~/composables/useSubcat'\r\n\r\nimport Multiselect from 'vue-multiselect'\r\nimport 'vue-multiselect/dist/vue-multiselect.css'\r\nconst { cats,  fetchCatsCommon } = useCat()\r\nconst { subcats,  fetchSubcatsCommon } = useSubcat()\r\n\r\nconst { prods, currentPage, lastPage, changePage, pageNumbers, fetchProds } = useProdPagination()\r\n\r\ndefinePageMeta({\r\n  middleware: 'auth',\r\n  layout: 'admin'\r\n});\r\n\r\nimport { useRuntimeConfig } from '#imports'\r\n\r\nconst config = useRuntimeConfig()\r\nconst router = useRouter()\r\nconst route = useRoute()\r\n\r\nconst catidx = route.params.catid\r\nconst cat= ref(null)\r\n\r\nconst selectedCat = ref(catidx)\r\nconst selectedCat2 = ref(catidx)\r\nconst selectedSubcat = ref(null)\r\n\r\nconst { $api } = useNuxtApp()\r\nconst apiUrl = useRuntimeConfig().public.apiBaseUrl\r\n\r\nconst fetchCat = async () => {\r\n  try {\r\n    \r\n    const response = await $api.get(`${apiUrl}/admin/cat/detail/${catidx}`)\r\n\t\r\n    cat.value = response.data\r\n\r\n\tconsole.log('line33' + response.data)\r\n\tconsole.log('line34' +response.data)\r\n\t\r\n  } catch (error) {\r\n    console.error('Error fetching item:', error.response ? error.response.data : error.message)\r\n  }\r\n}\r\n\r\n\r\n\r\nconst authStore = useAuthStore()\r\n\r\nonMounted(async () => {\r\n  await authStore.fetchUser()\r\n  await fetchCat()\r\n  await fetchProds(catidx)\r\n  \r\n  \r\n  await fetchCatsCommon()\r\n  await fetchSubcatsCommon(catidx)\r\n  selectedCat.value = catidx\r\n  selectedCat2.value = catidx\r\n})\r\nconst key = ref(0)\r\n\r\n\r\n\r\nconst refreshRoute = () => {\r\n\r\n  key.value += 1;\r\n\r\n\r\nrouter.replace({ path: route.path })\r\n    .then(() => {\r\n      console.log('Navigation ok, route replaced to ' + route.path);\r\n    })\r\n    .catch(err => {\r\n      console.error('Navigation error:', err);\r\n    });\r\n  console.log('end')\r\n  fetchProds(catidx)\r\n \r\n}\r\n\r\nwatch(route, async (newRoute, oldRoute) => {\r\n  console.log('Route changed from', oldRoute.path, 'to', newRoute.path);\r\n  await fetchprods(catidx);\r\n})\r\n\r\n\r\n\r\n\r\nconst viewProductsByCat = () => \r\n{\r\n\tif (selectedCat.value  != '' && selectedCat.value  != null && selectedCat.value  > 0) \r\n\t{\r\n\t\trouter.push(`/admin/prod/viewprodbycatid/${selectedCat.value}`)\r\n\t}\r\n\telse\r\n\t{\r\n\t\trouter.push(`/admin/prod/viewprod`)\r\n\t}\r\n\r\n}\r\n\r\nconst viewProductsByCatAndSubcat = () => \r\n{\r\n  \r\n\tif (selectedCat2.value && selectedCat2.value  != null && selectedCat2.value  > 0) \r\n\t{\r\n\t  if (selectedSubcat.value && selectedSubcat.value  != null && selectedSubcat.value  > 0) \r\n\t  {\r\n\t\trouter.push(`/admin/prod/viewprodbycatidsubid/${selectedCat2.value}/${selectedSubcat.value}`);\r\n\t  } \r\n\t  else \r\n\t  {\r\n\t\trouter.push(`/admin/prod/viewprodbycatid/${selectedCat2.value}`);\r\n\t  }\r\n\t}\r\n\telse\r\n\t{\r\n\t\trouter.push(`/admin/prod/viewprod`)\r\n\t}\r\n}\r\n\r\n</script>\r\n\r\n<template>\r\n\r\n\r\n<div  class=\"bg-gray-100 font-family-karla flex\">\r\n\t<Sidebar />\r\n\r\n    <div class=\"relative w-full flex flex-col h-screen overflow-y-hidden\">\r\n\r\n        <header class=\"w-full items-center bg-white py-2 px-6 hidden sm:flex\">\r\n            <div class=\"w-1/2\"></div>\r\n            <div  class=\"relative w-1/2 flex justify-end\"> View products by Category </div>\r\n        </header>\r\n\r\n       <MobileHeader />\r\n    \r\n        <div class=\"w-full h-screen overflow-x-hidden border-t flex flex-col\">\r\n            <main class=\"w-full flex-grow p-6\">\r\n\t\t\t<h1 class=\"text-2xl font-bold mb-4\">View Products By category {{ catidx }} </h1>\r\n\t\r\n\t\t\t<div v-if=\"cat\">\t\r\n\t\t\t\t<h1>Category Detail {{ cat.name }}</h1>\r\n\t\t\t\t\r\n\t\t\t\t<p v-if=\"cat.img\">\r\n\t\t\t\t  <img :src=\"`${config.public.BaseUrl}/images/cat/thumb/${cat.img}`\"\r\n\t\t\t\t  :alt=\"cat.name\" class=\"mt-2 mb-2\"/>\r\n\t\t\t\t</p> \r\n\t\t\t\t<p v-else>\r\n\t\t\t\t\t<img src=\"~/assets/default/1.jpg\" alt=\"Default Picture\" class=\"mt-2 mb-2 \"/>\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t\t<div v-else>\r\n\t\t\t<p>Loading category...</p>\r\n\t\t\t</div>\t\r\n\r\n\t\t\t<div class = 'fullwidth'>\r\n\t\t\t<h1 class=\"text-2xl font-bold mb-4\">View By Category</h1>\r\n\t\t\t<form @submit.prevent=\"viewProductsByCat\">\r\n\t\t\t\t<label for=\"catSelect\">Select Category:</label>\r\n\t\t\t\t<select v-model=\"selectedCat\" id=\"catSelect\" required\r\n\t\t\t\t  class=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 \r\n\t\t\t\t\tfocus:border-indigo-500 sm:text-sm width400px\">\r\n\t\t\t\t   <option value = null > All categories</option>\r\n\t\t\t\t   <option v-for=\"cat in cats\" :key=\"cat.id\" :value=\"cat.id\">\r\n\t\t\t\t\t{{ cat.name }} \r\n\t\t\t\t  </option>\r\n\t\t\t\t</select>\r\n\t\t\t\t<button type=\"submit\" class=\"mt-3 block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none width400px\">\r\n\t\t\t\tView Products By category</button>\r\n\t\t\t</form>\r\n\t\t\t</div>\t\r\n\t\t\t\r\n\t\t\t<div class = 'fullwidth mt-3'>\r\n\t\t\t\t <form @submit.prevent=\"viewProductsByCatAndSubcat\">\r\n\t\t\t\t\t<label for=\"catSelect2\">Select Category:</label>\r\n\t\t\t\t\t<select v-model=\"selectedCat2\" id=\"catSelect2\" \r\n\t\t\t\t\t@change=\"fetchSubcatsCommon(selectedCat2)\"\r\n\t\t\t\t\trequired\t\r\n\t\t\t\t\tclass=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 \r\n\t\t\t\t\tfocus:border-indigo-500 sm:text-sm width400px\">\r\n\t\t\t\t\t<option value = null  > All categories</option>\r\n\t\t\t\t\t  <option v-for=\"cat in cats\" :key=\"cat.id\" :value=\"cat.id\">\r\n\t\t\t\t\t\t{{ cat.name }}\r\n\t\t\t\t\t  </option>\r\n\t\t\t\t\t</select>\r\n\r\n\t\t\t\t\t<label for=\"subcatSelect\">Select Subcategory:</label>\r\n\t\t\t\t\t<select v-model=\"selectedSubcat\" id=\"subcatSelect\" required\r\n\t\t\t\t\tclass=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 \r\n\t\t\t\t\tfocus:border-indigo-500 sm:text-sm width400px\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t  <option value = null > All Subcategories</option>\r\n\t\t\t\t\t  <option v-for=\"subcat in subcats\" :key=\"subcat.id\" :value=\"subcat.id\">\r\n\t\t\t\t\t\t{{ subcat.name }} \r\n\t\t\t\t\t  </option>\r\n\t\t\t\t\t</select>\r\n\r\n\t\t\t\t\t<button type=\"submit\" \r\n\t\t\t\t\tclass=\"mt-3 block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none width400px\">\r\n\t\t\t\t\tView Products By category and Subcategory</button>\r\n\t\t\t\t  </form>\r\n\t\t\t</div>\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t<ProdsAdmin \r\n\t\t\t  :prods=\"prods\" \r\n\t\t\t  :currentPage=\"currentPage\" \r\n\t\t\t  :lastPage=\"lastPage\" \r\n\t\t\t  :changePage=\"changePage\" \r\n\t\t\t  :pageNumbers=\"pageNumbers\"  \r\n\t\t\t  :key=\"key.value\"\r\n\t\t\t  :catid=\"catidx\"\r\n\t\t\t/>\r\n\t\t\t<p>Current Route: {{ $route.path }}</p>\r\n\t\t\t<button @click.native=\"refreshRoute\"\r\n\t\t\tclass=\"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mt-3\">Refresh Route</button>\t\t\r\n            </main>\r\n            <footer class=\"w-full bg-white text-right p-4\"> </footer>\r\n        </div>\t\r\n\t</div>\t\r\n\t\t\r\n\t\t\r\n\t\t\r\n</div>\r\n</template>\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAcA,UAAM,EAAE,MAAO,gBAAiB,IAAG,OAAQ;AAC3C,UAAM,EAAE,SAAU,mBAAoB,IAAG,UAAW;AAEpD,UAAM,EAAE,OAAO,aAAa,UAAU,YAAY,aAAa,WAAY,IAAG,kBAAmB;AASjG,UAAM,SAAS,iBAAkB;AAClB,cAAW;AAC1B,UAAM,QAAQ,SAAU;AAExB,UAAM,SAAS,MAAM,OAAO;AAC5B,UAAM,MAAK,IAAI,IAAI;AAEnB,UAAM,cAAc,IAAI,MAAM;AAC9B,UAAM,eAAe,IAAI,MAAM;AAC/B,UAAM,iBAAiB,IAAI,IAAI;AAEd,eAAY;AACd,qBAAkB,EAAC,OAAO;AAmBvB,iBAAc;AAahC,UAAM,MAAM,IAAI,CAAC;AAqBjB,UAAM,OAAO,OAAO,UAAU,aAAa;AACzC,cAAQ,IAAI,sBAAsB,SAAS,MAAM,MAAM,SAAS,IAAI;AACpE,YAAM,WAAW,MAAM;AAAA,IACzB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}